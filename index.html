<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bot Setup Guide â€” Humanity Labs</title>
  <meta name="description" content="Build your own AI assistant in under an hour. Step-by-step guide by Humanity Labs.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23111'/><text y='66' font-size='44' font-family='system-ui' fill='%23d4a843' x='50' text-anchor='middle' font-weight='700'>HL</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #fafafa; --card: #fff;
      --border: #e5e5e5; --border-light: #f0f0f0;
      --text: #1a1a1a; --body: #444; --dim: #888;
      --accent: #b8922a; --accent-bg: rgba(184,146,42,.08); --accent-border: rgba(184,146,42,.3);
      --green: #16a34a; --green-bg: rgba(22,163,74,.07);
      --blue: #2563eb; --red: #dc2626;
      --radius: 12px;
      --sans: 'Inter', -apple-system, sans-serif;
    }
    * { margin: 0; padding: 0; box-sizing: border-box }
    body { font-family: var(--sans); background: var(--bg); color: var(--body); line-height: 1.75; font-size: 16px; -webkit-font-smoothing: antialiased }
    a { color: var(--accent); text-decoration: none } a:hover { text-decoration: underline }
    strong { color: var(--text) }
    code { background: #f0f0f0; padding: 2px 7px; border-radius: 4px; font-size: .85em; font-family: 'SF Mono', Consolas, monospace }

    header { padding: 18px 24px; border-bottom: 1px solid var(--border-light); display: flex; justify-content: space-between; align-items: center }
    .logo { font-size: 13px; font-weight: 700; color: var(--text) }
    .logo span { color: var(--dim); font-weight: 400 }
    header nav a { font-size: 13px; color: var(--dim); margin-left: 20px } header nav a:hover { color: var(--text) }

    .wizard { min-height: calc(100vh - 57px); display: flex; flex-direction: column; align-items: center; padding: 40px 24px 80px }
    .progress { width: 100%; max-width: 580px; margin-bottom: 40px }
    .progress-track { height: 3px; background: var(--border-light); border-radius: 2px; overflow: hidden }
    .progress-fill { height: 100%; background: var(--accent); border-radius: 2px; transition: width .4s ease }
    .progress-label { font-size: 12px; color: var(--dim); margin-top: 8px; text-align: right }

    .step-card { width: 100%; max-width: 580px; background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 36px 40px; animation: slide-in .25s ease }
    @keyframes slide-in { from { opacity: 0; transform: translateY(8px) } to { opacity: 1; transform: translateY(0) } }
    @media (max-width: 640px) { .step-card { padding: 24px 20px } }

    .step-phase { font-size: 11px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; color: var(--accent); margin-bottom: 6px }
    .step-title { font-size: 24px; font-weight: 800; color: var(--text); letter-spacing: -.02em; margin-bottom: 10px; line-height: 1.2 }
    .step-body { font-size: 15px; color: var(--body); line-height: 1.75 }
    .step-body p { margin-bottom: 12px } .step-body p:last-child { margin-bottom: 0 }
    .step-body ul { padding-left: 20px; margin-bottom: 12px }
    .step-body li { margin-bottom: 6px }

    .cmd-box { background: #1e1e2e; border-radius: 8px; padding: 13px 14px; margin: 12px 0; cursor: pointer; display: flex; align-items: center; gap: 10px; transition: opacity .15s }
    .cmd-box:hover { opacity: .9 }
    .cmd-box code { flex: 1; font-size: 13px; color: #a5b4fc; background: none; padding: 0; white-space: pre-wrap; word-break: break-all; line-height: 1.6 }
    .cmd-box-copy { font-size: 10px; font-weight: 700; color: rgba(255,255,255,.25); flex-shrink: 0 }
    .cmd-box.copied .cmd-box-copy { color: #6ee7b7 }

    .confirm-check { margin: 20px 0 0; padding: 16px; border: 1.5px solid var(--border); border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 12px; transition: border-color .15s, background .15s }
    .confirm-check:hover { border-color: var(--accent); background: var(--accent-bg) }
    .confirm-check.checked { border-color: var(--green); background: var(--green-bg) }
    .check-box { width: 20px; height: 20px; border-radius: 5px; border: 2px solid var(--border); flex-shrink: 0; display: flex; align-items: center; justify-content: center; transition: all .15s }
    .confirm-check.checked .check-box { border-color: var(--green); background: var(--green) }
    .check-mark { display: none; color: #fff; font-size: 12px; font-weight: 800 }
    .confirm-check.checked .check-mark { display: block }
    .check-label { font-size: 14px; color: var(--body) }
    .confirm-check.checked .check-label { color: var(--text) }

    .note { padding: 12px 14px; border-radius: 8px; background: var(--border-light); font-size: 13px; color: var(--body); margin: 12px 0; line-height: 1.6 }
    .note.gold { background: var(--accent-bg); border: 1px solid var(--accent-border) }

    .step-nav { display: flex; gap: 10px; margin-top: 28px; align-items: center }
    .btn { padding: 11px 24px; border-radius: 9px; font-size: 15px; font-weight: 600; cursor: pointer; transition: all .15s; font-family: var(--sans); border: none }
    .btn-primary { background: var(--accent); color: #fff }
    .btn-primary:hover { background: #a07d24 }
    .btn-primary:disabled { opacity: .4; cursor: not-allowed }
    .btn-secondary { background: var(--border-light); color: var(--body) }
    .btn-secondary:hover { background: var(--border) }
    .btn-skip { background: none; color: var(--dim); font-size: 13px; padding: 11px 16px; margin-left: auto }
    .btn-skip:hover { color: var(--body) }

    /* Form inputs */
    .key-field { margin: 14px 0 }
    .key-field label { display: block; font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 4px }
    .key-field .key-sub { font-size: 12px; color: var(--dim); font-weight: 400; margin-left: 4px }
    .key-field input { width: 100%; padding: 10px 12px; border: 1.5px solid var(--border); border-radius: 8px; font-size: 14px; font-family: 'SF Mono', Consolas, monospace; background: var(--card); color: var(--text); transition: border-color .15s }
    .key-field input:focus { outline: none; border-color: var(--accent) }
    .key-field input::placeholder { color: var(--dim) }
    .key-field .key-help { font-size: 12px; color: var(--dim); margin-top: 4px }
    .key-field .key-help a { color: var(--accent) }

    /* Bot config */
    .bot-card { border: 1.5px solid var(--border); border-radius: 10px; padding: 16px; margin: 12px 0 }
    .bot-card-header { display: flex; align-items: center; gap: 10px; margin-bottom: 12px }
    .bot-card-header input { flex: 1; padding: 8px 10px; border: 1.5px solid var(--border); border-radius: 6px; font-size: 14px; font-family: var(--sans) }
    .bot-card-header select { padding: 8px 10px; border: 1.5px solid var(--border); border-radius: 6px; font-size: 13px; font-family: var(--sans); background: var(--card) }
    .bot-remove { font-size: 18px; color: var(--dim); cursor: pointer; padding: 4px 8px; border-radius: 4px } .bot-remove:hover { color: var(--red); background: rgba(220,38,38,.08) }
    .add-bot-btn { display: inline-flex; align-items: center; gap: 6px; padding: 8px 14px; border: 1.5px dashed var(--border); border-radius: 8px; font-size: 13px; color: var(--dim); cursor: pointer; background: none; font-family: var(--sans); transition: all .15s }
    .add-bot-btn:hover { border-color: var(--accent); color: var(--accent) }

    /* Generated config */
    .config-box { background: #1e1e2e; border-radius: 10px; padding: 16px; margin: 16px 0; max-height: 300px; overflow: auto }
    .config-box pre { font-size: 12px; color: #c4b5fd; line-height: 1.6; white-space: pre-wrap; word-break: break-all; font-family: 'SF Mono', Consolas, monospace }

    footer { text-align: center; padding: 20px; font-size: 12px; color: var(--dim) }
    footer a { color: var(--dim) } footer a:hover { color: var(--accent) }
  </style>
</head>
<body>

<header>
  <div class="logo">Bot Setup Guide <span>by Humanity Labs</span></div>
  <nav>
    <a href="https://openclaw.ai">OpenClaw</a>
    <a href="https://obsidianclaw.ai">ObsidianClaw</a>
  </nav>
</header>

<div class="wizard">
  <div class="progress" id="progress">
    <div class="progress-track"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
    <div class="progress-label" id="progressLabel">Getting started</div>
  </div>
  <div id="stepContainer"></div>
</div>

<footer>
  <a href="https://humanitylabs.org">Humanity Labs</a> Â· <a href="https://obsidianclaw.ai">ObsidianClaw</a> Â· <a href="https://openclaw.ai">OpenClaw</a>
</footer>

<script>
// â”€â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const state = {
  hasOpenclaw: null,
  keys: { claude1: '', claude2: '', googleai: '', brave: '', elevenlabs: '' },
  bots: [{ name: 'Assistant', model: 'anthropic/claude-sonnet-4-6' }],
};

const models = [
  { id: 'anthropic/claude-opus-4-6', label: 'Claude Opus 4' },
  { id: 'anthropic/claude-sonnet-4-6', label: 'Claude Sonnet 4' },
  { id: 'anthropic/claude-sonnet-4-5', label: 'Claude Sonnet 4.5' },
  { id: 'google/gemini-2.5-pro', label: 'Gemini 2.5 Pro' },
  { id: 'google/gemini-2.5-flash', label: 'Gemini 2.5 Flash' },
];

// â”€â”€â”€ Steps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

const steps = [

  // 0: Welcome
  {
    phase: '', title: 'Build your own AI assistant',
    body: `<p>This guide helps you set up a personal AI that runs 24/7, reads your files, searches the web, and chats from any device.</p>`,
    choices: [
      { label: "I need to install OpenClaw", goto: 1 },
      { label: "OpenClaw is already running", goto: 5 },
    ]
  },

  // 1: API Keys
  {
    phase: 'Setup',
    title: 'Your API keys',
    body: `<p>Your bot needs access to AI models and tools. Paste your keys below â€” they'll be baked into the install command. Nothing leaves your browser.</p>`,
    custom: 'keys',
    next: 2
  },

  // 2: Configure bots
  {
    phase: 'Setup',
    title: 'Configure your bots',
    body: `<p>How many AI assistants do you want? Each gets its own personality, memory, and workspace folder.</p>`,
    custom: 'bots',
    next: 3
  },

  // 3: Pick a machine
  {
    phase: 'Setup',
    title: 'Pick a machine',
    body: `
      <p>Your bot needs a computer that stays on 24/7:</p>
      <ul>
        <li><strong>Mac mini or spare laptop</strong> â€” plug it in, close the lid</li>
        <li><strong>Cloud server</strong> â€” Hetzner or DigitalOcean, $5/month</li>
        <li><strong>Raspberry Pi</strong> â€” tiny, silent, $35</li>
      </ul>
      <p>Open a <strong>terminal</strong> on that machine. Mac: press <strong>Cmd+Space</strong>, type <strong>Terminal</strong>, Enter. Cloud: <code>ssh root@your-server-ip</code>.</p>
    `,
    confirm: 'Terminal is open on my machine',
    next: 4
  },

  // 4: Install command
  {
    phase: 'Setup',
    title: 'Install OpenClaw',
    body: `<p>Run this command. It installs OpenClaw, Tailscale Serve, and your configuration in one shot:</p>`,
    custom: 'install',
    confirm: 'OpenClaw is installed and running',
    next: 6
  },

  // 5: Already have OpenClaw â€” Tailscale Serve
  {
    phase: 'Configure',
    title: 'Set up Tailscale Serve',
    body: `
      <p>Tailscale Serve gives your bot a private HTTPS address â€” no ports to open, no VPN to configure.</p>
      <p><strong>1. Install Tailscale</strong> (if you haven't):</p>
    `,
    cmd: '# Mac:\nbrew install --cask tailscale\n\n# Linux:\ncurl -fsSL https://tailscale.com/install.sh | sh && sudo tailscale up',
    body2: `<p><strong>2. Configure OpenClaw to use Tailscale Serve:</strong></p>`,
    cmd2: 'openclaw config set gateway.bind loopback\nopenclaw config set gateway.tailscale.mode serve\nopenclaw gateway restart',
    body3: `<p>Your bot is now reachable at <code>https://your-machine.tailXXXX.ts.net</code> from any device on your Tailscale network.</p>`,
    confirm: 'Tailscale Serve is working',
    next: 6
  },

  // 6: Configure bots (for existing users too)
  {
    phase: 'Configure',
    title: 'Configure your bots',
    body: `<p>Set up your AI assistants. Each gets its own workspace folder (like <code>AGENT-OSCAR</code>), personality, and memory.</p>`,
    custom: 'bots',
    next: 7
  },

  // 7: Obsidian on server
  {
    phase: 'Sync',
    title: 'Install Obsidian on the server',
    body: `
      <p>Obsidian is where your bot's files live. Install it on the bot's machine:</p>
    `,
    cmd: '# Mac:\nbrew install --cask obsidian\n\n# Linux: download from obsidian.md/download',
    body2: `
      <p>Open Obsidian â†’ <strong>"Open folder as vault"</strong> â†’ select <code>~/.openclaw/workspace</code></p>
      <p>Your vault will look like this:</p>
      <div class="config-box"><pre>~/.openclaw/workspace/
â”œâ”€â”€ AGENT-YOURBOT/     â† bot workspace (one per bot)
â”‚   â”œâ”€â”€ SOUL.md
â”‚   â”œâ”€â”€ MEMORY.md
â”‚   â””â”€â”€ memory/
â”œâ”€â”€ Your folders/      â† your personal notes
â””â”€â”€ ...</pre></div>
    `,
    confirm: 'Obsidian is open with the vault',
    next: 8
  },

  // 8: Obsidian Sync
  {
    phase: 'Sync',
    title: 'Sync to your devices',
    body: `
      <p><a href="https://obsidian.md/sync" target="_blank">Obsidian Sync</a> ($4/month) keeps your bot's notes on all your devices in real time.</p>
      <p><strong>On the server:</strong> Obsidian â†’ Settings â†’ Sync â†’ Enable â†’ Sign in â†’ "Create new remote vault"</p>
      <p><strong>On your phone + laptop:</strong> Install <a href="https://obsidian.md/download" target="_blank">Obsidian</a> + <a href="https://tailscale.com/download" target="_blank">Tailscale</a>, then: Settings â†’ Sync â†’ Sign in â†’ Connect to your vault</p>
    `,
    confirm: 'Notes sync across my devices',
    next: 9
  },

  // 9: Install plugin
  {
    phase: 'Connect',
    title: 'Install the chat plugin',
    body: `
      <p>On <strong>each device</strong> (phone, laptop, server):</p>
      <p><strong>1.</strong> Obsidian â†’ Settings â†’ Community Plugins â†’ turn off Safe Mode â†’ Browse â†’ search <strong>BRAT</strong> â†’ Install â†’ Enable</p>
      <p><strong>2.</strong> Settings â†’ BRAT â†’ "Add Beta Plugin" â†’ paste:</p>
    `,
    cmd: 'oscarhenrycollins/obsidianclaw',
    body2: `<p>â†’ click "Add Plugin". The setup wizard opens automatically and walks you through connecting to your bot.</p>
      <p>It needs your <strong>Gateway URL</strong> (shown after Tailscale Serve setup, like <code>https://your-machine.tailXXXX.ts.net</code>) and <strong>auth token</strong>:</p>`,
    cmd2: 'cat ~/.openclaw/openclaw.json | grep token',
    confirm: 'Plugin connected â€” I can see the chat sidebar',
    next: 10
  },

  // 10: Done
  {
    phase: 'ğŸ‰ All done',
    title: "You're set up",
    body: `
      <p>Your personal AI is running 24/7 and accessible from every device.</p>
      <ul>
        <li>ğŸ’¬ Chat in the Obsidian sidebar on phone, laptop, anywhere</li>
        <li>ğŸ“ Browse your bot's files, memory, and notes in the vault</li>
        <li>ğŸ”€ Switch between bots with the agent switcher</li>
        <li>ğŸ—£ï¸ Send any note as context: <strong>Cmd+P â†’ "Ask about this note"</strong></li>
      </ul>
    `,
    isDone: true
  }
];

// â”€â”€â”€ Wizard engine â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

let current = 0;

function render(index) {
  current = index;
  const step = steps[index];
  const total = steps.length - 1;
  const pct = Math.round((index / total) * 100);
  document.getElementById('progressFill').style.width = pct + '%';
  document.getElementById('progressLabel').textContent = step.isDone ? 'Complete!' : (step.phase || 'Getting started');

  const container = document.getElementById('stepContainer');
  container.innerHTML = '';
  const card = document.createElement('div');
  card.className = 'step-card';

  let html = '';
  if (step.phase) html += `<div class="step-phase">${step.phase}</div>`;
  html += `<div class="step-title">${step.title}</div>`;
  html += `<div class="step-body">${step.body || ''}</div>`;

  // Choices
  if (step.choices) {
    html += `<div style="display:flex;flex-direction:column;gap:10px;margin-top:20px">`;
    step.choices.forEach((c, i) => {
      html += `<button class="confirm-check" onclick="goTo(${c.goto})" style="cursor:pointer;text-align:left">
        <div class="check-box"><span class="check-mark" style="display:block">â†’</span></div>
        <span class="check-label">${c.label}</span>
      </button>`;
    });
    html += `</div>`;
  }

  // Custom sections
  if (step.custom === 'keys') html += renderKeysForm();
  if (step.custom === 'bots') html += renderBotsForm();
  if (step.custom === 'install') html += renderInstallCommand();

  // Commands
  if (step.cmd) html += cmdBox(step.cmd, 'cmd1');
  if (step.body2) html += `<div class="step-body">${step.body2}</div>`;
  if (step.cmd2) html += cmdBox(step.cmd2, 'cmd2');
  if (step.body3) html += `<div class="step-body">${step.body3}</div>`;
  if (step.note) html += `<div class="note">${step.note}</div>`;

  // Confirm
  if (step.confirm && !step.isDone) {
    html += `<div class="confirm-check" id="confirmBox" onclick="toggleConfirm()">
      <div class="check-box"><span class="check-mark">âœ“</span></div>
      <span class="check-label">${step.confirm}</span>
    </div>`;
  }

  // Nav
  if (!step.choices) {
    html += `<div class="step-nav">`;
    if (index > 0) html += `<button class="btn btn-secondary" onclick="goTo(${index - 1})">â† Back</button>`;
    if (!step.isDone) {
      const nextLabel = step.nextLabel || 'Next â†’';
      const disabled = step.confirm ? 'disabled id="nextBtn"' : 'id="nextBtn"';
      html += `<button class="btn btn-primary" ${disabled} onclick="goTo(${step.next})">${nextLabel}</button>`;
    } else {
      html += `<a href="https://obsidianclaw.ai" class="btn btn-primary" style="text-decoration:none">Learn more about ObsidianClaw â†’</a>`;
    }
    html += `</div>`;
  }

  card.innerHTML = html;
  container.appendChild(card);
  if (step.custom === 'keys') bindKeyInputs();
  if (step.custom === 'bots') bindBotInputs();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

// â”€â”€â”€ API Keys form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function renderKeysForm() {
  return `
    <div class="key-field">
      <label>Claude OAuth Token <span class="key-sub">(required)</span></label>
      <input type="password" id="key-claude1" placeholder="sk-ant-..." value="${esc(state.keys.claude1)}">
      <div class="key-help">From <a href="https://console.anthropic.com/settings/keys" target="_blank">console.anthropic.com</a> â€” or a Claude Max subscription OAuth token</div>
    </div>
    <div class="key-field">
      <label>Claude Token #2 <span class="key-sub">(optional â€” for parallel requests)</span></label>
      <input type="password" id="key-claude2" placeholder="sk-ant-..." value="${esc(state.keys.claude2)}">
    </div>
    <div class="key-field">
      <label>Google AI API Key <span class="key-sub">(optional â€” enables Gemini models)</span></label>
      <input type="password" id="key-googleai" placeholder="AIza..." value="${esc(state.keys.googleai)}">
      <div class="key-help">Free at <a href="https://aistudio.google.com/apikey" target="_blank">aistudio.google.com</a></div>
    </div>
    <div class="key-field">
      <label>Brave Search API Key <span class="key-sub">(optional â€” web search)</span></label>
      <input type="password" id="key-brave" placeholder="BSA..." value="${esc(state.keys.brave)}">
      <div class="key-help">Free at <a href="https://brave.com/search/api/" target="_blank">brave.com/search/api</a></div>
    </div>
    <div class="key-field">
      <label>ElevenLabs API Key <span class="key-sub">(optional â€” voice/TTS)</span></label>
      <input type="password" id="key-elevenlabs" placeholder="sk_..." value="${esc(state.keys.elevenlabs)}">
      <div class="key-help">Free at <a href="https://elevenlabs.io" target="_blank">elevenlabs.io</a></div>
    </div>
    <div class="note gold">ğŸ”’ Keys stay in your browser. Nothing is sent to any server. The install command runs entirely on your machine.</div>
  `;
}

function bindKeyInputs() {
  ['claude1','claude2','googleai','brave','elevenlabs'].forEach(k => {
    const el = document.getElementById('key-' + k);
    if (el) el.addEventListener('input', () => { state.keys[k] = el.value.trim(); });
  });
}

// â”€â”€â”€ Bot config form â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function renderBotsForm() {
  let html = '<div id="botList">';
  state.bots.forEach((bot, i) => {
    html += `
      <div class="bot-card">
        <div class="bot-card-header">
          <input type="text" id="bot-name-${i}" placeholder="Bot name" value="${esc(bot.name)}">
          <select id="bot-model-${i}">
            ${models.map(m => `<option value="${m.id}" ${m.id === bot.model ? 'selected' : ''}>${m.label}</option>`).join('')}
          </select>
          ${state.bots.length > 1 ? `<span class="bot-remove" onclick="removeBot(${i})">Ã—</span>` : ''}
        </div>
      </div>`;
  });
  html += '</div>';
  html += `<button class="add-bot-btn" onclick="addBot()">+ Add another bot</button>`;
  html += `<div class="note">Each bot gets a folder like <code>AGENT-YOURBOT/</code> in your Obsidian vault with its own personality and memory.</div>`;
  return html;
}

function bindBotInputs() {
  state.bots.forEach((bot, i) => {
    const nameEl = document.getElementById('bot-name-' + i);
    const modelEl = document.getElementById('bot-model-' + i);
    if (nameEl) nameEl.addEventListener('input', () => { bot.name = nameEl.value; });
    if (modelEl) modelEl.addEventListener('change', () => { bot.model = modelEl.value; });
  });
}

function addBot() {
  state.bots.push({ name: '', model: 'anthropic/claude-sonnet-4-6' });
  render(current);
}

function removeBot(i) {
  if (state.bots.length <= 1) return;
  state.bots.splice(i, 1);
  render(current);
}

// â”€â”€â”€ Install command generator â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function renderInstallCommand() {
  const config = generateConfig();
  const configB64 = btoa(unescape(encodeURIComponent(JSON.stringify(config, null, 2))));
  const installCmd = `curl -fsSL https://openclaw.ai/install.sh | bash && echo '${configB64}' | base64 -d > ~/.openclaw/openclaw.json && openclaw gateway restart`;

  return `
    <div class="cmd-box" onclick="copyCmd(this, document.getElementById('installCmdText').textContent)">
      <code id="installCmdText" style="font-size:12px">${escHtml(installCmd)}</code>
      <span class="cmd-box-copy">copy</span>
    </div>
    <p style="font-size:13px;color:var(--dim);margin-top:8px">This installs OpenClaw, writes your config with all API keys, and starts the gateway.</p>
    <details style="margin-top:16px">
      <summary style="font-size:13px;color:var(--dim);cursor:pointer">Preview generated config</summary>
      <div class="config-box"><pre>${escHtml(JSON.stringify(config, null, 2))}</pre></div>
    </details>
  `;
}

function generateConfig() {
  const config = {
    auth: { profiles: {} },
    agents: {
      defaults: {
        model: { primary: state.bots[0]?.model || 'anthropic/claude-sonnet-4-6' },
      }
    },
    gateway: {
      port: 18789,
      bind: 'loopback',
      tailscale: { mode: 'serve' },
      auth: { mode: 'token', allowTailscale: true }
    }
  };

  // Claude tokens
  if (state.keys.claude1) {
    config.auth.profiles['anthropic:default'] = { provider: 'anthropic', mode: 'token' };
  }
  if (state.keys.claude2) {
    config.auth.profiles['anthropic:secondary'] = { provider: 'anthropic', mode: 'token' };
  }

  // Google AI
  if (state.keys.googleai) {
    config.auth.profiles['google:default'] = { provider: 'google', mode: 'api_key' };
  }

  // Brave search
  if (state.keys.brave) {
    config.tools = config.tools || {};
    config.tools.web = { search: { apiKey: state.keys.brave } };
  }

  // ElevenLabs
  if (state.keys.elevenlabs) {
    config.messages = { tts: { provider: 'elevenlabs', elevenlabs: { apiKey: state.keys.elevenlabs } } };
  }

  // Multi-agent
  if (state.bots.length > 1) {
    config.agents.list = state.bots.map((bot, i) => {
      const id = i === 0 ? 'main' : bot.name.toLowerCase().replace(/[^a-z0-9]/g, '-') || `bot-${i}`;
      const folderName = 'AGENT-' + (bot.name || 'BOT').toUpperCase().replace(/[^A-Z0-9]/g, '-');
      return {
        id,
        name: bot.name || `Bot ${i + 1}`,
        workspace: `~/.openclaw/workspace/${folderName}`,
        model: bot.model !== config.agents.defaults.model.primary ? bot.model : undefined
      };
    }).map(a => { if (!a.model) delete a.model; return a; });
  } else if (state.bots[0]?.name) {
    const folderName = 'AGENT-' + state.bots[0].name.toUpperCase().replace(/[^A-Z0-9]/g, '-');
    config.agents.defaults.workspace = `~/.openclaw/workspace/${folderName}`;
  }

  return config;
}

// â”€â”€â”€ Utilities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

function goTo(i) { if (i >= 0 && i < steps.length) render(i); }

function toggleConfirm() {
  const box = document.getElementById('confirmBox');
  if (!box) return;
  box.classList.toggle('checked');
  const btn = document.getElementById('nextBtn');
  if (btn) btn.disabled = !box.classList.contains('checked');
}

function copyCmd(el, text) {
  navigator.clipboard.writeText(text.replace(/\\n/g, '\n'));
  el.classList.add('copied');
  const s = el.querySelector('.cmd-box-copy'); if (s) s.textContent = 'copied âœ“';
  setTimeout(() => { el.classList.remove('copied'); if (s) s.textContent = 'copy'; }, 1500);
}

function cmdBox(cmd, id) {
  return `<div class="cmd-box" id="${id}" onclick="copyCmd(this,'${escAttr(cmd)}')">
    <code>${escHtml(cmd)}</code><span class="cmd-box-copy">copy</span></div>`;
}

function esc(s) { return (s||'').replace(/"/g, '&quot;'); }
function escHtml(s) { return (s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function escAttr(s) { return (s||'').replace(/'/g,"\\'").replace(/\n/g,'\\n'); }

render(0);
</script>
</body>
</html>
